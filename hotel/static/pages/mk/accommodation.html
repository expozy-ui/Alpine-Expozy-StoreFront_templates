<div class="is-section is-box  is-section-50   min-height-60 last-box !p-0">
    <div class="is-overlay">
        <div class="is-overlay-bg brightness-50" style="background-image: url(&quot;/static/images/1920x1080.webp&quot;); background-position: 50% 60%;"></div>
    </div>
    <div class="!container is-container v2">
        <div class="text-center">
            <h2 class="mb-[12px] 2xl:text-[40px] xl:text-[38px] lg:text-[36px] md:text-[34px] sm:text-[30px] text-[28px] font-bold text-white">Сместување</h2>
            <h5 class="text-[16px]">
                <span>
                    <a href="index.html" class="text-[#fff] hover:text-[#fff]">Почетна</a>
                </span>
                <span class="font-bold text-white"> / </span>
                <span>
                    <a href="javascript:void(0)" class="text-[#fff] hover:text-[#fff]">Сместување</a>
                </span>
            </h5>
        </div>
    </div>
</div>

<div class="w-full relative  z-1 lg:mt-10 lock">
    <div class="grid grid-cols-1">
        <form>
            <div class=" shadow max-w-[1000px] mx-auto  hover:shadow-md lg:p-5 p-2 bg-white rounded-xl">
                <div class="grid lg:grid-cols-3 grid-cols-2 gap-2">

                    <div class="col-span-3 relative flatpickr-input active" x-init="initCalendar($el)" readonly="readonly">
                        <div class="grid grid-cols-2 gap-2  disabled block rounded-md  w-full text-sm text-gray-900 bg-white  ">
                            <div class="relative border border-gray-200 rounded-md">
                                <input :value="data.date_start" name="date_start" id="date_start" keyName="hotel_room_types" class="disabled block  px-4 pb-2.5 pt-5 w-full text-sm  text-gray-900 bg-white rounded-l-lg  appearance-none focus:outline-none focus:ring-0 focus:border-black peer " placeholder=" " type="text" readonly="readonly">
                                <label for="date_start" class="absolute pl-2 text-sm text-gray-500  duration-300 transform -translate-y-4 scale-75 top-4 z-10 origin-[0] start-2.5 peer-focus:text-black peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4  ">Пристигнување</label>
                                <i class="fa-light fa-calendar-days absolute top-4 right-4 text-2xl text-gray-600" aria-hidden="true"></i>
                            </div>

                            <div class="relative border border-gray-200 rounded-md">
                                <input :value="data.date_end" name="date_end" id="date_end" class="disabled block text-left px-4 pb-2.5 pt-5 w-full text-sm  text-gray-900 bg-white rounded-r-lg  appearance-none focus:outline-none focus:ring-0 focus:border-black peer " placeholder=" " type="text" readonly="readonly">
                                <label for="date_end" class="absolute pr-2 text-sm text-gray-500  duration-300 transform -translate-y-4 scale-75 top-4 z-10 origin-[0] start-2.5 peer-focus:text-black peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4  ">Заминување</label>
                                <i class="fa-light fa-calendar-days absolute top-4 right-4 text-2xl text-gray-600" aria-hidden="true"></i>
                            </div>
                        </div>

                        <div class="text-left">
                            <input type="hidden" name="errDate">
                        </div>
                    </div>

                    <!-- <div class="col-span-1 relative " @mousedown.outside="show = false" x-data="{show:false, adult:0, childs:0, infants:0, pets:0}">
                        <div @click="show = true" class="text-left">
                            <input :value="data.guestsSearch" type="number" name="guestsSearch" id="guests" class="block rounded-md px-4 pb-2.5 pt-5 w-full text-sm shadow text-gray-900 bg-white border border-gray-200 appearance-none hover:shadow-2xl shadow-lg  focus:outline-none focus:ring-0 focus:border-black peer" placeholder=" ">
                            <label for="guests" class="absolute pl-2 text-sm text-gray-500  duration-300 transform -translate-y-4 scale-75 top-4 z-10 origin-[0] start-2.5 peer-focus:text-black peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-4  ">Гости</label>
                            <i class="fa-light fa-people absolute top-4 right-4 text-2xl text-gray-600" aria-hidden="true"></i>
                        </div>
                    </div> -->

                </div>
            </div>
        </form>
    </div>
</div>

<section class="section-room-detsils xl:py-[40px] py-[20px] lock">
    <div class="flex flex-wrap justify-between items-start mx-auto container">
        <div :class="data.hotelCart.rooms != undefined ? 'lg:w-9/12' : 'lg:w-full' " class="w-full px-[12px] mb-[24px] ">
            <div class="">
                <div class="container ">

                    <div :class="data.hotelCart.rooms != undefined ? 'lg:grid-cols-3' : 'lg:grid-cols-4' " class="lg:grid-cols-3 grid items-center grid-cols-1 md:grid-cols-2  gap-5 md:gap-[30px]">
                        <template x-for="room in data.hotel_room_types">

                            <div class="overflow-x-hidden h-full border-[1px] border-[#e8e8e8] flex flex-col  ">
                                <div class="relative group">
                                    <div class="overflow-hidden rounded-lg">
                                        <img :src="room.images[0].url ? room.images[0].url : Helpers.image('product')" class="w-full h-full object-cover aspect-square group-group-hover:scale-110 transition-all duration-300" alt="">
                                    </div>
                                    <template x-if="room.price">
                                        <div class="px-5 3xl:px-6 py-2 inline-flex bg-[#c3a460] text-sm rounded-lg  items-center justify-center text-white  absolute top-[10px] right-[10px] ">
                                            <span class="mr-1">од </span>
                                            <span x-amount="room.price">120 </span>
                                            <span class="mx-2">|</span>
                                            <span>ноќ</span>
                                        </div>
                                    </template>

                                    <button @click="href(`/mk/room?id=${room.id}`)" :class="data.screenWidth < 1024 && '!left-0'" class="flex items-center justify-center text-[15px] rounded-r-lg leading-[38px] bg-black hover:bg-[#c3a460]  absolute bottom-0 -left-40 px-6 py-1 text-white  group-hover:left-0 transition-all duration-300">
                                        <i class="fa-thin fa-arrow-right-long ml-2 mt-1"></i>
                                    </button>

                                </div>

                                <div class="p-2  rounded-b-lg grow flex flex-col justify-between border-t-0">
                                    <div class="">
                                        <h4 x-text="room.title" class="text-lg leading-[26px]  uppercase font-semibold">Двојна Стандардна соба</h4>

                                        <div class="">

                                            <span class=" text-xs font-normal text-gray mt-2  flex gap-1 ">
                                                <i class="fa-solid fa-user-vneck-hair text-xs"></i>
                                                <span class="ml-[5px]  ">до <span x-text="room.guests"> </span> лица</span>
                                            </span>

                                            <span class=" text-xs font-normal text-gray mt-2  flex gap-1 ">
                                                <i class="fa-regular fa-bed-front text-xs"></i>
                                                <span x-text="room.desc_bed" class="ml-[5px]  ">2 двојни кревети</span>
                                            </span>

                                            <p class="text-sm font-normal text-gray mt-2  flex gap-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16.442" height="16.441" viewBox="0 0 16.442 16.441" tabindex="-1" role="none" focusable="false" aria-hidden="true">
                                                    <path d="M16.289,15.56.883.153A.518.518,0,0,0,0,.519V15.926a.517.517,0,0,0,.517.517H15.924a.518.518,0,0,0,.366-.883ZM1.034,15.408V1.768L3.025,3.758l-.371.371a.517.517,0,1,0,.731.731l.371-.371,1.5,1.5-.371.371a.517.517,0,0,0,.731.731l.371-.371,1.5,1.5-.371.371a.517.517,0,0,0,.731.731l.371-.371,1.5,1.5-.371.371a.517.517,0,0,0,.731.731l.371-.371,1.5,1.5-.371.371a.517.517,0,0,0,.731.731l.371-.371,1.991,1.991Z" transform="translate(0 -0.001)"></path>
                                                    <path d="M103.133,258.2a.966.966,0,0,0-1.648.683v2.892a.967.967,0,0,0,.966.966h2.892a.966.966,0,0,0,.683-1.648Zm-.614,3.506v-2.657l2.657,2.657Z" transform="translate(-98.205 -249.582)"></path>
                                                </svg>
                                                <span x-text="room.quadrature" class="text-xs">40 </span>
                                                <span>кв.м.</span>
                                            </p>

                                        </div>
                                    </div>

                                    <div>
                                        <p class="text-sm pt-4 pb-2 font-semibold text-gray-800">Удобности во собата </p>
                                        <div class="flex gap-2 flex-wrap pb-4">
                                            <template x-for="prop in room.properties.filter(obj=> obj.property.show_on_checkout == true) ">
                                                <div class="flex gap-1 items-center">
                                                    <p class="icon" x-html="prop.property.icon"></p>
                                                    <p class="text-xs" x-text="prop.property.title"></p>
                                                </div>
                                            </template>

                                        </div>
                                    </div>

                                    <style>
                                        .icon svg {
                                            width: 20px !important;
                                        }
                                    </style>

                                    <!-- <div>
                                            <p class="text-gray-800 text-sm flex gap-1 pb-4 items-center">Дознајте повеќе <i class="fa-thin fa-arrow-right-long text-gray-800"></i></p>
                                        </div> -->

                                    <div class="  border-t-[1px]  border-[#e8e8e8]  "> </div>
                                    <p class="text-gray-800 text-sm flex gap-1 pb-1 items-center"><i class="fa-light fa-retweet"></i> БЕСПЛАТНО откажување</p>
                                    <p class="text-gray-800 text-sm flex gap-1 pb-1 items-start"><i class="fa-regular fa-credit-card"></i>Плаќање со банкарски трансфер</p>

                                    <template x-if="!room.price">
                                        <p @click="href(`/mk/room?id=${room.id}`)" class="hover:bg-black border border-gray-400 text-gray-800 hover:text-white rounded-lg w-full btn py-1">Прочитај повеќе</p>
                                    </template>

                                    <template x-if="room.price">
                                        <p @click="data.addRoom = room;" class="hover:bg-black border border-gray-400 text-gray-800 hover:text-white rounded-lg w-full btn py-1">Изберете</p>
                                    </template>

                                </div>

                            </div>

                        </template>
                    </div>

                    <template x-if="data.hotel_room_types.length == 0 || data.hotel_room_types == undefined ">
                        <p class="text-lg leading-[26px]  uppercase font-semibold">Нема достапни соби</p>
                    </template>
                </div>
            </div>
        </div>

        <template x-if="data.hotelCart.rooms != undefined && ((data.openCart && data.screenWidth < 1024) || data.screenWidth > 1024)">

            <div x-show="data.hotelCart.rooms != undefined && ((data.openCart && data.screenWidth < 1024) || data.screenWidth > 1024)" x-transition x-cloak class="lg:w-3/12 w-full  px-0 lg:px-[12px] mb-[24px] aos-init aos-animate  lg:order-last fixed lg:relative top-0  lg:block z-50 lg:z-10 h-full lg:h-fit overflow-y-auto">
                <div class=" shadow-lg border border-gray-200 rounded-lg    ">

                    <h4 class=" p-[20px] text-2xl font-semibold  uppercase bg-white shadow-lg text-black rounded-t-lg  text-center  border-b border-solid border-gray-200 flex justify-between lg:justify-center items-center">
                        Мојата резервација
                        <template x-if="data.screenWidth < 1024">
                            <i @click="data.openCart = false " class="fa-solid fa-xmark cursor-pointer  text-[24px]" aria-hidden="true"></i>
                        </template>

                    </h4>

                    <div class="   pt-0 pr-[24px] pl-[24px] pb-[24px] divide-y divide-gray-200  bg-white text-gray-800 text-lg  ">

                        <template x-if="data.hotelCart.rooms != undefined">
                            <div class=" text-center py-4 text-lg">
                                <p class="pt-2 text-sm text-center  ">
                                    <span x-text="data.hotelCart.rooms[0].nights_count"></span>
                                    <span>ноќевања</span>
                                </p>

                                <span x-text="Helpers.formatDate(data.hotelCart.rooms[0].date_start)" x-text2="data.hotelCart.rooms[0].date_start">22 август</span>
                                <span>-</span>
                                <span x-text="Helpers.formatDate(data.hotelCart.rooms[0].date_end)" x-text2="data.hotelCart.rooms[0].date_end">24 август</span>
                            </div>
                        </template>

                        <template x-for="(room, index) in data.hotelCart.rooms" :key="index">
                            <div class="py-4">
                                <div class="flex justify-center items-center">
                                    <div class="text-xs text-center">
                                        <span class=" ">Соба </span>
                                        <span x-text="index + 1"></span>
                                        <span> : </span>
                                    </div>
                                </div>

                                <p x-text="Object.values(data.hotel_room_types).find(obj => obj.id == room.type_id).title" class="text-base">Соба Делукс со поглед кон паркот</p>
                                <p class="text-xs text-red-600 cursor-pointer font-semibold" @click="alpineListeners('Hotel.post_hotel_calculate', $event)" data-delete="1" :data-index="index">отстрани</p>

                                <p class="text-right">

                                    <span x-amount="room.price_total" class="text-base font-semibold">600 </span>
                                </p>

                            </div>
                        </template>

                        <div class="py-2 text-center mt-4">
                            <p class="text-right text-2xl pt-2 pb-8 font-semibold flex justify-between ">
                                <span>Вкупно</span>
                                <span x-amount="data.hotelCart.price_total"></span>
                            </p>

                            <button @click="href('/mk/checkout')" class="group relative inline-flex items-center justify-start overflow-hidden rounded-md px-5 w-2/3 py-3 ">
                                <span class="absolute left-0 top-0 h-32 w-32 -translate-y-2 translate-x-12 rotate-45 bg-gray-800 opacity-[3%]"></span>
                                <span class="absolute left-0 top-0 -mt-1 h-48 w-48 -translate-x-56 -translate-y-24 rotate-45 bg-gray-800 opacity-100 transition-all duration-500 ease-in-out group-hover:-translate-x-8"></span>
                                <span class="relative w-full text-left text-gray-800 transition-colors duration-200 ease-in-out group-hover:text-white font-normal uppercase"> Продолжи</span>
                                <span class="absolute inset-0 rounded-md border border-gray-800"></span>
                            </button>
                        </div>

                    </div>
                </div>
            </div>
        </template>
    </div>
</section>

<script>
    async function initCalendar(el) {
        await Helpers.loadFile(`/assets/plugins/flatpicker/flatpicker.css`);
        await Helpers.loadFile(`/assets/plugins/flatpicker/flatpicker.js`);

        data.date_start = localStorage.getItem('date_start');
        data.date_end = localStorage.getItem('date_end');


        let flatpickrInstance = flatpickr(el, {
            dateFormat: 'Y-m-d',
            minDate: 'today',
            mode: "range",
            defaultDate: data.date_start && data.date_end ? [data.date_start, data.date_end] : null,
            onChange: function (selectedDates, dateStr, instance) {
                let datesSplit = dateStr.split(' ');

                if (datesSplit.length >= 2) {
                    document.getElementById('date_start').value = datesSplit[0];
                    document.getElementById('date_end').value = datesSplit[2];

                    localStorage.setItem('date_start', datesSplit[0]);
                    localStorage.setItem('date_end', datesSplit[2]);

                    data.date_start = datesSplit[0];
                    data.date_end = datesSplit[2];

                    alpineListeners('Hotel.get_hotel_room_types', document.getElementById('date_start'));

                } else {
                    document.getElementById('date_start').value = '';
                    document.getElementById('date_end').value = '';
                }
            }
        });

        alpineListeners('Hotel.get_hotel_room_types', document.getElementById('date_start'));
    }
</script>
